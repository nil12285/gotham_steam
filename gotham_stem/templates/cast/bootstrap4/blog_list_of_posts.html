{% extends "base.html" %}
{% load wagtailcore_tags %}
{% load crispy_forms_tags %}
{% load static %}
{% load django_vite %}

{% block body_class %}template-bloglistpage{% endblock %}

{% block meta %}
  {{ block.super }}
  {% if blog.noindex %}
    <meta name="robots" content="noindex">
  {% endif %}
  <link rel="canonical" href="{{ canonical_url }}">
{% endblock %}

{% block extra_css %}
<style>
</style>
{% endblock %}

{% block content %}
<section class="about-section py-5">
    <div class="container py-4">
        <div class="row align-items-start gx-5">
            <div class="col-lg-8 order-2 order-md-1">
                <h1 class="display-4 fw-normal mb-4 text-light-blue fw-bold">{{page.title}}</h1>
                
                <div class="about-content lead-sm">
                    {{page.description|richtext}}
                </div>
            </div>
        </div>
    </div>
</section>
<section class="posts-section">
  <div class="container">
    
    <div class="row mb-5 ms-4 justify-content-start">
      <div class="col-md-4 col-lg-3">
        <form action="" method="get" class="input-group border border-light-blue">
            <span class="input-group-text bg-transparent border-0 text-light-blue">
                <i class="bi bi-search"></i>
            </span>
            
            <input type="text" 
                name="search" 
                class="form-control bg-transparent border-0 text-dark-purple placeholder-light-purple" 
                placeholder="search by topic"
                value="{{ request.GET.search|default:'' }}">
      </form>
      </div>
    </div>

    <main class="row g-4">
        {% if request.GET.search %}
        <div class="mt-3 text-start px-md-5 mb-md-1">
            <medium class="text-muted">
            Showing results for "{{ request.GET.search }}". 
                <a href="{{ request.path }}" class="text-dark-purple text-decoration-underline">Show all posts</a>
            </medium>
        </div>
        {% endif %}
        {% for post in posts %}
            <div class="col-12 col-md-6 col-lg-4 px-md-5 mb-md-5">
            {% include "./article_card.html" with post=post display_description=True %}
            </div>
        {% endfor %}
    </main>

    <footer class="mt-5 d-flex justify-content-center">
      {% include "./pagination.html" %}
    </footer>
  </div>
</section>

{% endblock content %}


{% block javascript %}
  {{ block.super }}
  {% vite_hmr_client app="cast" %}
  {% vite_asset 'src/gallery/image-gallery-bs4.ts' app="cast" %}
  {% vite_asset 'src/audio/podlove-player.ts' app="cast" %}
{% endblock javascript %}